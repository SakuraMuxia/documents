# åå°„

## åŸºæœ¬æ¦‚å¿µ

ğŸš€ **ä½œç”¨**ï¼šåœ¨ç¨‹åºè¿è¡ŒæœŸé—´ï¼ŒåŠ¨æ€çš„è·å–ç±»å¯¹è±¡ï¼Œä»è€Œä½¿ç”¨ç±»å¯¹è±¡è·å–ç±»ä¸­ç›¸å…³çš„ä¿¡æ¯å¹¶ä¸”è®¿é—®ï¼›

**é€šä¿—çš„è®²**ï¼šä¸é€šè¿‡newå¯¹è±¡çš„æ–¹å¼ï¼Œä¾ç„¶å¯ä»¥è®¿é—®ç±»ä¸­çš„å±æ€§ã€æ–¹æ³•ã€æ„é€ æ–¹æ³•ï¼›

```java
ç”Ÿæ´»ä¸­çš„åå°„ï¼šå€’è½¦é•œï¼Œæ‹Xå…‰ç‰‡ï¼ŒIDEçš„è‡ªåŠ¨æç¤ºï¼Œ
    åœ¨å¤–éƒ¨å°±å¯ä»¥å¾—åˆ°å†…éƒ¨çš„ä¸œè¥¿ï¼Œç±»ä¼¼äºä¸€ä¸ªé•œå­ï¼Œé€šè¿‡é•œå­èƒ½çœ‹åˆ°åè¾¹çš„å†…å®¹ã€‚è¿™å°±æ˜¯åå°„ã€‚
ä¸‡ç‰©çš†å¯¹è±¡ ç±»ã€å±æ€§ã€æ–¹æ³•ã€æ„é€ å™¨ ä¹Ÿå±äºå¯¹è±¡ã€‚
```

ğŸ¨ åå°„ç±»ä»‹ç»

`java.lang.Class` ç±»ç±»ï¼Œæ¯ä¸€ä¸ªç±»éƒ½å°†åœ¨ç±»åŠ è½½é˜¶æ®µè‡ªåŠ¨äº§ç”Ÿæ­¤ç±»çš„å®ä¾‹ï¼›

`java.lang.reflect.Field` å­—æ®µ/å±æ€§ç±»ï¼Œä»»ä½•ä¸€ä¸ªå±æ€§éƒ½å±äºæ­¤ç±»çš„å®ä¾‹ï¼›

`java.lang.reflect.Method` æ–¹æ³•ç±»ï¼Œä»»ä½•ä¸€ä¸ªæ–¹æ³•éƒ½å±äºæ­¤ç±»çš„å®ä¾‹ï¼›

`java.lang.Constructor `æ„é€ å™¨ç±»ï¼Œä»»ä½•ä¸€ä¸ªæ„é€ å™¨éƒ½å±äºæ­¤ç±»çš„å®ä¾‹ï¼›



## è·å–Classå¯¹è±¡

ğŸš€ æ–¹å¼1ï¼šé€šè¿‡Class.forName è·å–Classå¯¹è±¡

```java
// æ–¹å¼1ï¼šé€šè¿‡Class.forName è·å–Classå¯¹è±¡ ( Stringç±»å‹çš„ å…¨é™å®šå)
// åªèƒ½åœ¨è¿è¡Œæ—¶ï¼Œè·å–åˆ°ä¼ å…¥çš„å‚æ•°ï¼Œæ— æ³•åœ¨ç¼–è¯‘æ—¶å¾—çŸ¥Classç±»å¯¹è±¡çš„ç±»å‹
Class<?> aClass = Class.forName("com.ReflectPart.Singer");
System.out.println("aClass = " + aClass); // class com.ReflectPart.Singer
```

ğŸš€ æ–¹å¼2ï¼šä½¿ç”¨ç±»å.classå±æ€§ è·å–Classå¯¹è±¡

```java
// æ–¹å¼2ï¼šä½¿ç”¨ç±»å.classå±æ€§ è·å–Classå¯¹è±¡
// åœ¨ç¼–è¯‘æ—¶ï¼Œå°±å¾—çŸ¥Classç±»å¯¹è±¡çš„ç±»å‹ï¼Œæ‰€ä»¥å¯ä»¥æå‰å¾—çŸ¥Classç±»å‹çš„å¯¹è±¡ï¼Œæ³›å‹ä¸ºSinger
Class<Singer> singerClass = Singer.class;
System.out.println("singerClass = " + singerClass); // class com.ReflectPart.Singer
```

ğŸš€ æ–¹å¼3ï¼šä½¿ç”¨Objectç±»ä¸­getClass() æ–¹æ³•ï¼Œè·å–Classå¯¹è±¡ï¼ˆå®ä¾‹æ–¹æ³•ï¼‰

```java
// æ–¹å¼3ï¼šä½¿ç”¨Objectç±»ä¸­getClass() æ–¹æ³•ï¼Œè·å–Classå¯¹è±¡ï¼ˆå®ä¾‹æ–¹æ³•ï¼‰
// åœ¨ç¼–è¯‘æ—¶ï¼Œå¯ä»¥å¾—çŸ¥Classç±»å‹çš„å¯¹è±¡ä¸ºSingerç±»æˆ–Singerç±»çš„å­ç±»ï¼Œ
Singer hanser = new Singer();
Class<? extends Singer> aClass1 = hanser.getClass();
System.out.println("aClass1 = " + aClass1); // class com.ReflectPart.Singer
```

## Classç±»

ç±»æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªç±»

**æ–¹æ³•**

newInstance()

```java
ä½œç”¨ï¼šåˆ›å»ºå½“å‰Classå¯¹è±¡æ‰€å¯¹åº”æ³›å‹çš„å®ä¾‹ï¼ˆå®ä¾‹æ–¹æ³•ï¼‰ï¼Œè°ƒç”¨å½“å‰ç±»å¯¹è±¡ä¸­çš„æ— å‚æ„é€ åˆ›å»ºå¯¹è±¡ã€‚
    
å‚æ•°ï¼šæ— 
    
è¿”å›å€¼ï¼šå®ä¾‹å¯¹è±¡
    
ç¤ºä¾‹ï¼š
// æ–¹å¼2ï¼šä½¿ç”¨ç±»å.classå±æ€§ è·å–Classå¯¹è±¡
// åœ¨ç¼–è¯‘æ—¶ï¼Œå°±å¾—çŸ¥Classç±»å¯¹è±¡çš„ç±»å‹ï¼Œæ‰€ä»¥å¯ä»¥æå‰å¾—çŸ¥Classç±»å‹çš„å¯¹è±¡ï¼Œæ³›å‹ä¸ºSinger
Class<Singer> singerClass = Singer.class;
System.out.println("singerClass = " + singerClass); // class com.ReflectPart.Singer

// è¿”å›ä¸€ä¸ª Singer (æ³›å‹)ç±»å‹çš„å®ä¾‹
Singer singer = singerClass.newInstance()
```

getField(String fieldName)

```java
ä½œç”¨ï¼šæ ¹æ®å­—æ®µåç§°è·å–åˆ°ä¸€ä¸ªpublicä¿®é¥°çš„å­—æ®µå¯¹è±¡
    
å‚æ•°ï¼šStringç±»å‹
    
è¿”å›å€¼ï¼šFieldç±»å‹
    
ç¤ºä¾‹ï¼š
    
// è·å–Classå¯¹è±¡
Class<?> stuClass = Class.forName("com.yuluochenxiao.Student");
    
// è·å–å­—æ®µå¯¹è±¡
Field field = stuClass.getField("age");
```

getFields()

```java
ä½œç”¨ï¼šè·å–æœ¬ç±»ä¸­æ‰€æœ‰çš„publicå…³é”®å­—ä¿®é¥°çš„å­—æ®µ
    
å‚æ•°ï¼šæ— 
    
è¿”å›å€¼ï¼šFieldç±»å‹çš„æ•°ç»„
    
ç¤ºä¾‹ï¼š

// è·å–Classå¯¹è±¡
Class<?> stuClass = Class.forName("com.yuluochenxiao.Student");
    
// è·å–å­—æ®µå¯¹è±¡
Field[] fields = stuClass.getFields();

// éå†
fields.for
```

getDeclaredField(String name)

```java
ä½œç”¨ï¼šè·å–åˆ°æŒ‡å®šçš„æœ¬ç±»ä¸­å·²å®šä¹‰çš„å­—æ®µ(ç§æœ‰çš„ä¹Ÿå¯ä»¥è·å–åˆ°ï¼Œä½†è·å–ä¸åˆ°çˆ¶ç±»ä¸­çš„æ–¹æ³•)
    
å‚æ•°ï¼šå­—æ®µçš„Stringåç§°
    
è¿”å›å€¼ï¼šFieldå¯¹è±¡
    
ç¤ºä¾‹ï¼š

// è·å–Classå¯¹è±¡
Class<?> stuClass = Class.forName("com.yuluochenxiao.Student");
    
// è·å–å­—æ®µå¯¹è±¡
Field field = stuClass.getDeclaredField("name");

```

getDeclaredFields() 

```java
ä½œç”¨ï¼šè·å–åˆ°æœ¬ç±»ä¸­æ‰€æœ‰çš„å·²å®šä¹‰çš„å­—æ®µï¼ˆä½†è·å–ä¸åˆ°çˆ¶ç±»ä¸­çš„æ–¹æ³•ï¼‰
    
å‚æ•°ï¼šæ— 
    
è¿”å›å€¼ï¼šFieldå¯¹è±¡æ•°ç»„
    
ç¤ºä¾‹ï¼š

// è·å–Classå¯¹è±¡
Class<?> stuClass = Class.forName("com.yuluochenxiao.Student");
    
// è·å–å­—æ®µå¯¹è±¡
Field[] fields = stuClass.getDeclaredFields();

// éå†
fields.for
```

getMethod(String name,...paramsType)

```java
getMethod(String name,Class<?>...paramsType)
ä½œç”¨ï¼šè·Ÿæ®åå­—è·å–æœ¬ç±»publicä¿®é¥°çš„ä»¥åŠç»§æ‰¿çˆ¶ç±»çš„æ–¹æ³•
    
å‚æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°æ˜¯Stringç±»å‹çš„æ–¹æ³•åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯å˜é•¿å‚æ•°ã€‚
    ç¬¬äºŒä¸ªå‚æ•°é»˜è®¤ä¸ä¼ ä»£è¡¨ï¼Œå‚æ•°ä¸ºç©ºã€‚
    è‹¥æ–¹æ³•ä¸­çš„å‚æ•°ä¸ºintç±»å‹ ä¾‹å¦‚ public void m1(int age){}
		åˆ™å‚æ•°ä¸º intç±»å‹çš„classå¯¹è±¡ï¼Œå³ä¸º int.class
    
    
è¿”å›å€¼ï¼šMethodç±»å‹å¯¹è±¡
    
ç¤ºä¾‹ï¼š

// åˆ›å»ºç±»Classå¯¹è±¡
Class<?> vupClass = Class.forName("com.ReflectPart.getMethod.Vup");
    
// è·å–æ–¹æ³•å¯¹è±¡
Method m3 = vupClass.getMethod("m3", int.class, String.class);

// å¿½ç•¥JVMè­¦å‘Š
m3.setAccessible(true);
m3.invoke(o,18,"hanser");
```

getMethods()

```java
ä½œç”¨ï¼šè·å–æ‰€æœ‰æœ¬ç±»publicä¿®é¥°çš„ä»¥åŠç»§æ‰¿çˆ¶ç±»çš„æ–¹æ³•
    
å‚æ•°ï¼šæ— 
    
è¿”å›å€¼ï¼šMethodç±»å‹çš„å¯¹è±¡æ•°ç»„
    
ç¤ºä¾‹ï¼š

// è·å–Classå¯¹è±¡
Class<?> stuClass = Class.forName("com.yuluochenxiao.Student");
    
// è·å–å­—æ®µå¯¹è±¡
Method[] methods = stuClass.getMethods();

```

getDeclareMethod(String name,paramsType )

```java
ä½œç”¨ï¼šæ ¹æ®å‚æ•°è·å–æœ¬ç±»ä¸­å·²å®šä¹‰çš„æ–¹æ³•ï¼ˆåŒ…å«ç§æœ‰çš„ï¼‰
    
å‚æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°æ˜¯Stringç±»å‹çš„æ–¹æ³•åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯å˜é•¿å‚æ•°ï¼ˆå½¢å‚åˆ—è¡¨ï¼‰ã€‚
    
è¿”å›å€¼ï¼šMethodç±»å‹çš„å¯¹è±¡
    
ç¤ºä¾‹ï¼š

// åˆ›å»ºç±»Classå¯¹è±¡
Class<?> vupClass = Class.forName("com.ReflectPart.getMethod.Vup");

// è·å–æœ¬ç±»ä¸­å·²å®šä¹‰çš„æ–¹æ³•(ç§æœ‰æ–¹æ³•)
Method m31 = vupClass.getDeclaredMethod("m3", String.class, int.class);
```

getDeclareMethods()

```java
ä½œç”¨ï¼šè·å–æœ¬ç±»æ‰€æœ‰å·²å®šä¹‰çš„ä»¥åŠç»§æ‰¿çˆ¶ç±»çš„æ–¹æ³•ï¼ˆåŒ…å«ç§æœ‰çš„ï¼‰
    
å‚æ•°ï¼šæ— 
    
è¿”å›å€¼ï¼šMethodç±»å‹çš„å¯¹è±¡æ•°ç»„
    
ç¤ºä¾‹ï¼š

// åˆ›å»ºç±»Classå¯¹è±¡
Class<?> vupClass = Class.forName("com.ReflectPart.getMethod.Vup");

// è·å–æœ¬ç±»ä¸­å·²å®šä¹‰çš„æ–¹æ³•(ç§æœ‰æ–¹æ³•)
Method m31 = vupClass.getDeclaredMethod("m3", String.class, int.class);
Method[] declaredMethods = vupClass.getDeclaredMethods();
```

getConstructor()

```java
ä½œç”¨ï¼šè·å–æŒ‡å®šçš„ç±»çš„publicä¿®é¥°çš„æ„é€ æ–¹æ³•ï¼ˆæ ¹æ®å½¢å‚åˆ—è¡¨ä¸åŒè¿›è¡Œç­›é€‰ï¼‰
    
å‚æ•°ï¼šå½¢å‚çš„Classå¯¹è±¡
    
è¿”å›å€¼ï¼šè¿”å›ä¸€ä¸ª Constructorå¯¹è±¡
    
ç¤ºä¾‹ï¼š
// è·å–classç±»å¯¹è±¡
Class<?> vupClass = Class.forName("com.ReflectPart.Vup");
// è·å–æ— å‚æ„é€ 
Constructor<?> constructor = vupClass.getConstructor();
// è·å–æœ‰å‚æ„é€ 
Constructor<?> constructor1 = vupClass.getConstructor(String.class, int.class, int.class);

```

getConstructors() 

```java
ä½œç”¨ï¼šè·å–ç±»çš„æ‰€æœ‰publicä¿®é¥°çš„æ„é€ æ–¹æ³•
    
å‚æ•°ï¼šæ— 
    
è¿”å›å€¼ï¼šè¿”å›æ•°ç»„ Constructorå¯¹è±¡
    
ç¤ºä¾‹ï¼š
    
// è·å–classç±»å¯¹è±¡
Class<?> vupClass = Class.forName("com.ReflectPart.Vup");
// è·å–æ— å‚æ„é€ 
Constructor<?>[] constructors = vupClass.getConstructors();
// éå†
for (Constructor<?> constructor : constructors) {
    System.out.println(constructor.getName() + " " +constructor.getParameterCount());
}
```

getDeclaredConstructor(...parameterTypes)

```java
ä½œç”¨ï¼šè·å–æŒ‡å®šå½¢å‚çš„æ„é€ æ–¹æ³•
    
å‚æ•°ï¼šå½¢å‚çš„Classå¯¹è±¡
    
è¿”å›å€¼ï¼šè¿”å›Constructorå¯¹è±¡
    
ç¤ºä¾‹ï¼š
// è·å–classç±»å¯¹è±¡
Class<?> vupClass = Class.forName("com.ReflectPart.Vup");
// è·å–æ— å‚æ„é€ 
Constructor<?> constructor = vupClass.getConstructor(String.class, int.class, int.class);
```

getDeclaredConstructors()

```java
ä½œç”¨ï¼šè·å–æ‰€æœ‰è®¿é—®ä¿®é¥°ç¬¦ä¿®é¥°çš„æ„é€ æ–¹æ³•
    
å‚æ•°ï¼šæ— 
    
è¿”å›å€¼ï¼šè¿”å›æ•°ç»„ Constructorå¯¹è±¡
    
ç¤ºä¾‹ï¼š
    
 // è·å–classç±»å¯¹è±¡
Class<?> vupClass = Class.forName("com.ReflectPart.Vup");
// è·å–æ— å‚æ„é€ 
Constructor<?>[] constructors = vupClass.getConstructors();
// éå†
for (Constructor<?> constructor : constructors) {
    System.out.println("constructor = " + constructor);
}
```



## Fieldç±»

ç±»ä¸­çš„å±æ€§ä¹Ÿæœ‰è‡ªå·±çš„ç±»ï¼ˆç±»å‹å®šä¹‰ï¼Œä¸‡ç‰©çš†å¯¹è±¡ï¼‰

**æ–¹æ³•**

getName()

```java
ä½œç”¨ï¼šè·å–å­—æ®µçš„åç§°
    
å‚æ•°ï¼šæ— 
    
è¿”å›å€¼ï¼šString
    
ç¤ºä¾‹ï¼š

// è·å–Classå¯¹è±¡
Class<?> stuClass = Class.forName("com.yuluochenxiao.Student");
    
// è·å–å­—æ®µå¯¹è±¡
Field field = stuClass.getField("age");

// è·å–å­—æ®µçš„åç§°
field.getName()
```

getType()

```java
ä½œç”¨ï¼šè·å–å­—æ®µçš„ç±»å‹
    
å‚æ•°ï¼šæ— 
    
è¿”å›å€¼ï¼šString
    
ç¤ºä¾‹ï¼š

// è·å–Classå¯¹è±¡
Class<?> stuClass = Class.forName("com.yuluochenxiao.Student");
    
// è·å–å­—æ®µå¯¹è±¡
Field field = stuClass.getField("age");

// è·å–å­—æ®µçš„ç±»å‹
field.getType() // åŸºæœ¬æ•°æ®ç±»å‹ã€æ•°ç»„ã€ç­‰
```

getModifiers()

```java
ä½œç”¨ï¼šè·å–å­—æ®µçš„Javaè¯­è¨€è®¿é—®ä¿®é¥°ç¬¦
    1 ä»£è¡¨æ˜¯publicä¿®é¥°çš„
    
å‚æ•°ï¼šæ— 
    
è¿”å›å€¼ï¼šString
    
ç¤ºä¾‹ï¼š

// è·å–Classå¯¹è±¡
Class<?> stuClass = Class.forName("com.yuluochenxiao.Student");
    
// è·å–å­—æ®µå¯¹è±¡
Field field = stuClass.getField("age");

// è·å–å­—æ®µçš„ç±»å‹
field.getType() // åŸºæœ¬æ•°æ®ç±»å‹ã€æ•°ç»„ã€ç­‰
```

set()

```java
ä½œç”¨ï¼šç»™å±æ€§èµ‹å€¼ã€‚
    
å‚æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å“ªä¸€ä¸ªå­¦ç”Ÿå¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯èµ‹å€¼
    
è¿”å›å€¼ï¼šæ— 
    
ç¤ºä¾‹ï¼š
// è·å–Classå¯¹è±¡
Class<?> stuClass = Class.forName("com.yuluochenxiao.Student");
    
// è·å–å­—æ®µå¯¹è±¡
Field field1 = stuClass.getField("age");
    
// è·å–å¯¹è±¡ï¼ˆæ–¹å¼1ï¼‰
// Student stu = new Student();
Object o = stuClass.newInstance()

// èµ‹å€¼ï¼ˆæ–¹å¼1ï¼‰
// field1.set(stu,12);
field1.set(o,12);
```

get()

```java
ä½œç”¨ï¼šè·å–å±æ€§çš„å€¼ã€‚
    
å‚æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å“ªä¸€ä¸ªå¯¹è±¡
    
è¿”å›å€¼ï¼šFieldç±»å‹
    
ç¤ºä¾‹ï¼š
// è·å–Classå¯¹è±¡
Class<?> stuClass = Class.forName("com.yuluochenxiao.Student");
    
// è·å–å­—æ®µå¯¹è±¡
Field field1 = stuClass.getField("age");
    
// è·å–å¯¹è±¡
Object o = stuClass.newInstance()

// è·å–å±æ€§å€¼
field1.get(o);
```

setAccessible()

```java
ä½œç”¨ï¼šå¿½ç•¥JVMçš„å®‰å…¨æ£€æŸ¥ã€‚å³å¯ä»¥åœ¨ä¸åœ¨åŒç±»ä¸­è®¿é—®ç§æœ‰å±æ€§
    ï¼ˆä¸é€šè¿‡åå°„æ˜¯æ— æ³•è®¿é—®ç§æœ‰å±æ€§çš„ï¼ŒåŸå› æ˜¯åœ¨ç¼–è¯‘æœŸé—´å°±æ— æ³•é€šè¿‡ï¼‰
    ï¼ˆåå°„æ˜¯åœ¨è¿è¡Œæ—¶æ‰ç”¨åˆ°çš„ï¼Œç»•è¿‡çš„ç¼–è¯‘çš„æ£€æŸ¥ï¼Œä½†æ˜¯åœ¨è¿è¡ŒæœŸé—´ä»ä¼šæŠ›å¼‚å¸¸ï¼Œé€šè¿‡è®¾ç½®å¿½ç•¥é£é™©ï¼Œä»èƒ½å¤Ÿè·å–åˆ°ç§æœ‰å±æ€§ï¼‰
    
å‚æ•°ï¼šå¸ƒå°”å€¼ trueï¼Œå¿½ç•¥å®‰å…¨æ£€æŸ¥
    
è¿”å›å€¼ï¼šæ— 
    
ç¤ºä¾‹ï¼š
// è·å–Classå¯¹è±¡
Class<?> stuClass = Class.forName("com.yuluochenxiao.Student");
    
// è·å–å­—æ®µå¯¹è±¡
Field field1 = stuClass.getField("age");
    
// å¿½ç•¥JVMçš„å®‰å…¨æ£€æŸ¥ï¼Œè®¿é—®ç§æœ‰å±æ€§
field1.setAccessible(true)
```

getAnnotation(annotationClass)

```java
ä½œç”¨ï¼šè·å–æŸä¸ªå…ƒç´ ï¼ˆç±»/æ–¹æ³•/å­—æ®µç­‰ï¼‰ä¸ŠæŒ‡å®šç±»å‹çš„æ³¨è§£å¯¹è±¡
    
å‚æ•°ï¼šæ³¨è§£ç±»å‹classå¯¹è±¡
    
è¿”å›å€¼ï¼šæ³¨è§£å®ä¾‹å¯¹è±¡ Annotationç±»å‹çš„æ³›å‹ UserName è‡ªå·±
    
ç¤ºä¾‹ï¼š
Class<?> dataClass = Class.forName("com.ReflectPart.AnnoAndReflect.DataBaseDemo.DataInfo");
Field declaredField = dataClass.getDeclaredField("userName");
 // è·å–æ³¨è§£å®ä¾‹å¯¹è±¡
UserName name = declaredField.getAnnotation(UserName.class);
// è·å–æ³¨è§£å±æ€§çš„å€¼,å®ä¾‹çš„æ–¹æ³•å°±æ˜¯ æ³¨è§£å®šä¹‰çš„å±æ€§çš„åç§°
String value = name.value();
```

getAnnotations()

```java
ä½œç”¨ï¼šè·å–å½“å‰å±æ€§ä¸Šæ·»åŠ çš„æ‰€æœ‰æ³¨è§£ï¼ŒåŒ…å«ç»§æ‰¿è‡ªçˆ¶ç±»çš„æ³¨è§£å¯¹è±¡ã€‚
    
å‚æ•°ï¼šæ— 
    
è¿”å›å€¼ï¼šæ³¨è§£å®ä¾‹å¯¹è±¡æ•°ç»„[username,password]
    
ç¤ºä¾‹ï¼š
    
Class<?> dataClass = Class.forName("com.ReflectPart.AnnoAndReflect.DataBaseDemo.DataInfo");
// è·å–å±æ€§
Field declaredField = dataClass.getDeclaredField("password");
Annotation[] annotations = declaredField.getAnnotations();
for (Annotation annotation : annotations) {
    System.out.println(annotation);
}
```

getDeclaredAnnotation(annotationClass)

```java
ä½œç”¨ï¼šè·å–æŒ‡å®šç±»å‹çš„æ³¨è§£å¯¹è±¡ï¼Œå¦‚æœå­—æ®µä¸Šæœ‰è¿™ä¸ªæ³¨è§£ï¼Œå°±è¿”å›æ³¨è§£çš„å®ä¾‹ï¼Œå¦åˆ™è¿”å› nullï¼Œä¸åŒ…å«ç»§æ‰¿è‡ªçˆ¶ç±»çš„æ³¨è§£å¯¹è±¡
    
å‚æ•°ï¼šæ³¨è§£çš„classå¯¹è±¡
    
è¿”å›å€¼ï¼šæ³¨è§£ç±»å‹å®ä¾‹
    
ç¤ºä¾‹ï¼š
Class<?> dataClass = Class.forName("com.ReflectPart.AnnoAndReflect.DataBaseDemo.DataInfo");
// è·å–å±æ€§
Field declaredField = dataClass.getDeclaredField("password");
Driver drive = declaredField.getDeclaredAnnotation(Driver.class);
System.out.println("drive.value() = " + drive.value()); // drive.value() = 123
```

getDeclaredAnnotations()

```java
ä½œç”¨ï¼šè·å–å½“å‰å±æ€§ä¸Šæ·»åŠ çš„æ‰€æœ‰æ³¨è§£ï¼Œä¸åŒ…å«ç»§æ‰¿è‡ªçˆ¶ç±»çš„æ³¨è§£å¯¹è±¡ã€‚
    
å‚æ•°ï¼šæ— 
    
è¿”å›å€¼ï¼šæ³¨è§£å®ä¾‹å¯¹è±¡æ•°ç»„ï¼Œæ¯ä¸€ä¸ªå…ƒç´ çš„æ˜¯Annotationç±»å‹ã€‚
    
ç¤ºä¾‹ï¼š
Class<?> dataClass = Class.forName("com.ReflectPart.AnnoAndReflect.DataBaseDemo.DataInfo");
// è·å–å±æ€§
Field declaredField = dataClass.getDeclaredField("password");
Annotation[] anns = declaredField.getDeclaredAnnotations();
for (Annotation ann : anns) {
    System.out.println(ann);
}
```

isAnnotationPresent()

```java
ä½œç”¨ï¼šåˆ¤æ–­æŸä¸ªå…ƒç´ ï¼ˆç±»/æ–¹æ³•/å­—æ®µç­‰ï¼‰ä¸Šæ˜¯å¦å­˜åœ¨æŒ‡å®šç±»å‹çš„æ³¨è§£
    
å‚æ•°ï¼šæ³¨è§£ç±»å‹classå¯¹è±¡ï¼Œå½“å‰å±æ€§ä¸Šæ–¹æ˜¯å¦æ·»åŠ äº†UserNameæ³¨è§£ã€‚
    
è¿”å›å€¼ï¼šå¸ƒå°”å€¼ï¼Œå­˜åœ¨æŒ‡å®šç±»å‹çš„æ³¨é‡Šï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false
    
ç¤ºä¾‹ï¼š
Class<?> dataClass = Class.forName("com.ReflectPart.AnnoAndReflect.DataBaseDemo.DataInfo");
Field declaredField = dataClass.getDeclaredField(username);
if (declaredField.isAnnotationPresent(UserName.class)){
    // è·å–æ³¨è§£å®ä¾‹å¯¹è±¡
    UserName name = declaredField.getAnnotation(UserName.class);
    // è·å–æ³¨è§£å±æ€§çš„å€¼
    String value = name.value();
    System.out.println("value = " + value);
}
```

## Methodç±»

æ–¹æ³•ç±»ï¼›`java.lang.reflect.Method` æ–¹æ³•ç±»ï¼Œä»»ä½•ä¸€ä¸ªæ–¹æ³•éƒ½å±äºæ­¤ç±»çš„å®ä¾‹ï¼›

**æ–¹æ³•**

getName()

```java
ä½œç”¨ï¼šè·å–æ–¹æ³•çš„åç§°
    
å‚æ•°ï¼šæ— 
    
è¿”å›å€¼ï¼šStringç±»å‹çš„æ–¹æ³•å
    
ç¤ºä¾‹ï¼š
// è·å–Classå¯¹è±¡
Class<?> stuClass = Class.forName("com.yuluochenxiao.Student");
    
// è·å–æ–¹æ³•æ•°ç»„
Method[] methods = stuClass.getMethods();
    
// è·å–æ–¹æ³•åç§°
for(Method method: methods){
    String name = method.getName();
    System.out.print(name)
}
```

getParameterCount()

```java
ä½œç”¨ï¼šè·å–æ–¹æ³•ä¸­å‚æ•°çš„ä¸ªæ•°
    
å‚æ•°ï¼šæ— 
    
è¿”å›å€¼ï¼šä¸ªæ•°
    
ç¤ºä¾‹ï¼š
// è·å–Classå¯¹è±¡
Class<?> stuClass = Class.forName("com.yuluochenxiao.Student");
    
// è·å–æ–¹æ³•æ•°ç»„
Method[] methods = stuClass.getMethods();
    
// è·å–æ–¹æ³•åç§°
for(Method method: methods){
    String name = method.getName();
    int count = method.getParameterCount();
    System.out.print(name)
}
```

invoke(obj,args)

```java
ä½œç”¨ï¼šè°ƒç”¨æ–¹æ³•ï¼ˆå®ä¾‹çº§åˆ«ï¼‰
    
å‚æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç»™è¿™ä¸ªæ–¹æ³•ä¼ é€’çš„å‚æ•°
    è‹¥æœ‰å‚æ•°ï¼Œç›´æ¥å†™å‚æ•°å³å¯ã€‚
    
è¿”å›å€¼ï¼šæ— 
    
ç¤ºä¾‹ï¼š
Class<?> vupClass = Class.forName("com.ReflectPart.getMethod.Vup");
// æ ¹æ®æŒ‡å®šåç§°å’Œå‚æ•°åˆ—è¡¨è·å–æ–¹æ³•å¯¹è±¡å®ä¾‹
Method m3 = vupClass.getMethod("m3", int.class, String.class);
// å¿½ç•¥JVMè­¦å‘Š
m3.setAccessible(true);
m3.invoke(o,18,"hanser");

```

setAccessible()

```java
ä½œç”¨ï¼šå¦‚åŒFieldä¸­çš„setAccessible()æ–¹æ³•ä½¿ç”¨ä¸€è‡´ï¼Œå¿½ç•¥JVMè­¦å‘Šã€‚
    
å‚æ•°ï¼štrue
    
è¿”å›å€¼ï¼šæ— 
    
ç¤ºä¾‹ï¼š
    
Class<?> vupClass = Class.forName("com.ReflectPart.getMethod.Vup");
// æ ¹æ®æŒ‡å®šåç§°å’Œå‚æ•°åˆ—è¡¨è·å–æ–¹æ³•å¯¹è±¡å®ä¾‹
Method m3 = vupClass.getMethod("m3", int.class, String.class);
// å¿½ç•¥JVMè­¦å‘Š
m3.setAccessible(true);
m3.invoke(o,18,"hanser");

```

## Constructorç±»

Constructoræä¾›äº†ä¸€ä¸ªç±»çš„å•ä¸ªæ„é€ å‡½æ•°çš„ä¿¡æ¯å’Œè®¿é—®ã€‚æ‰€æœ‰æ„é€ å™¨éƒ½å±äºæ­¤ç±»çš„å®ä¾‹ã€‚

**æ„é€ æ–¹æ³•**

```java
æ— 
```

**æ–¹æ³•**

getName()

```java
ä½œç”¨ï¼šä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›æ­¤æ„é€ å‡½æ•°çš„åç§°ã€‚
    
å‚æ•°ï¼šæ— 
    
è¿”å›å€¼ï¼šStringç±»å‹
    
ç¤ºä¾‹ï¼š
    
// è·å–classç±»å¯¹è±¡
Class<?> vupClass = Class.forName("com.ReflectPart.getConstructor.Vup");
// è·å–Contructorå¯¹è±¡
Constructor<?> constructor = vupClass.getConstructor();
// æ˜¾ç¤º
int parameterCount = constructor.getParameterCount();
String name = constructor.getName();
```

getParameterCount()

```java
ä½œç”¨ï¼šè¿”å›ç”±æ­¤å¯¹è±¡è¡¨ç¤ºçš„å¯æ‰§è¡Œæ–‡ä»¶çš„å½¢å¼å‚æ•°ï¼ˆæ— è®ºæ˜¯æ˜¾å¼å£°æ˜è¿˜æ˜¯éšå¼å£°æ˜ï¼‰çš„æ•°é‡ã€‚
    
å‚æ•°ï¼šæ— 
    
è¿”å›å€¼ï¼šintç±»å‹çš„æ•°é‡
    
ç¤ºä¾‹ï¼š
// è·å–classç±»å¯¹è±¡
Class<?> vupClass = Class.forName("com.ReflectPart.getConstructor.Vup");
// è·å–Contructorå¯¹è±¡
Constructor<?> constructor = vupClass.getConstructor();
// æ˜¾ç¤º
int parameterCount = constructor.getParameterCount();
String name = constructor.getName();
System.out.println("name:" + name + "| parameterTypes:" + parameterCount);
```

newInstance(Object ... args) 

```java
ä½œç”¨ï¼šæ ¹æ®ä¼ å…¥çš„å‚æ•°åˆ—è¡¨ è°ƒç”¨å¯¹åº”çš„æœ‰å‚æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡
    æ³¨æ„ï¼šå¦‚æœæœ‰é‡åçš„ç±»åï¼Œå¯ä»¥å†™åŒ…çš„å…¨ç§°ï¼Œä¾‹å¦‚ï¼š 
    java.lang.String.class æˆ– java.lang.util.Date.class
    
å‚æ•°ï¼šä¼ å…¥æœ‰å‚æ„é€ çš„å‚æ•°
    
è¿”å›å€¼ï¼šç±»çš„å®ä¾‹å¯¹è±¡
    
ç¤ºä¾‹ï¼š
        
// è·å–classç±»å¯¹è±¡
Class<?> vupClass = Class.forName("com.ReflectPart.Vup");
// è·å–æ— å‚æ„é€ 
Constructor<?> constructor = vupClass.getConstructor();
// è·å–æœ‰å‚æ„é€ 
Constructor<?> constructor1 = vupClass.getConstructor(String.class, int.class, int.class);

// åˆ›å»ºå®ä¾‹å¯¹è±¡
Object vup = constructor.newInstance();
Object vup1 = constructor1.newInstance("Hanser", 18, 175);
// vup: Vup{name='null', age=0, height=0}
System.out.println("vup: "+vup); 
// vup1: Vup{name='Hanser', age=18, height=175}
System.out.println("vup1: "+vup1); 
```

## åŸºæœ¬ä½¿ç”¨

> åå°„å¯ä»¥åœ¨è¿è¡ŒæœŸé—´ï¼ŒåŠ¨æ€çš„è·å–åˆ°ç±»ä¸­çš„æ‰€æœ‰ä¿¡æ¯ï¼ˆå±æ€§ï¼Œæ–¹æ³•ï¼Œå®ä¾‹ï¼Œæ„é€ æ–¹æ³•ï¼Œé™æ€æ–¹æ³•ç­‰ï¼‰ã€‚

âœï¸ åå°„è§£å†³ä¹‹å‰å® ç‰©ç³»ç»Ÿä¸­æŠ½å¥–é€å® ç‰©çš„é—®é¢˜ã€‚

```java
ä¹‹å‰çš„å®ç°æ–¹æ¡ˆï¼š
æ ¹æ®ç”¨æˆ·ä¼ å…¥å¯¹åº”çš„å‚æ•° æ¥åˆ›å»ºå¯¹è±¡çš„å® ç‰©å­ç±»å¯¹è±¡ è¿”å›ï¼›
    
å¼Šç«¯ï¼š
    è¿™æ ·ç¼–å†™æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºæ˜¯ç›´æ¥ç¡¬ç¼–ç çš„æ–¹å¼åˆ›å»ºå¯¹è±¡ã€‚
    æ‰€ä»¥æˆ‘ä»¬è€ƒè™‘åˆ°æœªæ¥å¯èƒ½æ–°å¢çš„ç±»ï¼Œå³æ–°çš„å® ç‰©å­ç±»ï¼Œè¿™æ ·çš„ä¹¦å†™æ–¹æ³•ï¼Œæ‰©å±•æ€§è¾ƒå·®ã€‚
    
ä½¿ç”¨åå°„çš„æ–¹å¼è§£å†³ï¼š
    åœ¨ç¼–ç æœŸé—´å¹¶ä¸ç›´æ¥å†™æ˜å…·ä½“åˆ›å»ºå“ªä¸ªå­ç±»å¯¹è±¡ï¼Œè€Œæ˜¯æ ¹æ®è°ƒç”¨è€…ä¼ å…¥çš„å…¨é™å®šåæ¥åˆ›å»ºå¯¹è±¡ã€‚
    è¿™æ ·æ›´åŠ çµæ´»ã€æ‰©å±•æ€§æ›´å¼ºã€ä¸ä¼šå—é™äºç¡¬ç¼–ç çš„å±€é™ã€‚     
```

ğŸ“ ç¤ºä¾‹1ï¼šä½¿ç”¨åå°„è§£å†³ç¼–è¯‘æœŸé—´ï¼Œæ— æ³•ç¡®å®šæœªæ¥æ–°å¢çš„ç±»ã€‚

ï¼ˆæœªä½¿ç”¨åå°„ï¼‰

```java
package com.ReflectPart.draw;
/**
 * å® ç‰©ç±» çˆ¶ç±»
 */
public class Pet {
    protected String name;

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Pet(String name) {
        this.name = name;
    }

    public Pet() {

    }

    public void print(){
        System.out.println("å® ç‰©çš„åå­—æ˜¯ï¼š" + name);
    }
}

```

```java
package com.ReflectPart.draw;

public class Dog extends Pet{
    private String strain;
    public Dog() {}

    public Dog(String name, String strain) {
        super(name);
        this.strain = strain;
    }
}

```

```java
package com.ReflectPart.draw;

public class Penguin extends Pet{
    private char gender;

    public char getGender() {
        return gender;
    }

    public void setGender(char gender) {
        this.gender = gender;
    }

    public Penguin() {}

    public Penguin(String name, char gender) {
        super(name);
        this.gender = gender;
    }
}

```

```java
package com.ReflectPart.draw;

public class Master {
    // æŠ½å¥–è·å–å® ç‰©æ–¹æ³•
    public Pet getPet(String str){
        // å¦‚æœä¸ä½¿ç”¨åå°„ï¼Œè¿™é‡Œè¿˜éœ€è¦åŠ å¾ˆå¤šåˆ¤æ–­ï¼Œå½“è·å¾—3ç­‰å¥–ä¹‹ç±»çš„æ“ä½œ
        if (str.equals("No1")){
            Penguin penguin = new Penguin("å°ç™½",'é›„');
            return penguin;
        } else if (str.equals("No2")){
            Dog dog = new Dog("å¤§é»„","é‡‘æ¯›");
            return dog;
        }else {
            Dog dog = new Dog("å°é»„","é‡‘æ¯›");
            return dog;
        }
    }
}

```

```java
package com.ReflectPart.draw;

public class Test {
    public static void main(String[] args) {
        Master mas = new Master();
        Pet pet = mas.getPet("No3");
        System.out.println("è·å¾—çš„å¥–å“æ˜¯ "+pet.name);
    }
}

```

### è·å–å¯¹è±¡

âš¡ï¸ é€šè¿‡æ–¹å¼2ï¼šè·å–Classå¯¹è±¡ï¼Œç„¶åå†è°ƒç”¨Objectç±»ä¸­çš„`newInstance`æ–¹æ³•ï¼Œåˆ›å»ºå¯¹è±¡ã€‚

```java
ä¹‹å‰çš„å®ç°æ–¹æ¡ˆï¼š
æ ¹æ®ç”¨æˆ·ä¼ å…¥å¯¹åº”çš„å‚æ•° æ¥åˆ›å»ºå¯¹è±¡çš„å® ç‰©å­ç±»å¯¹è±¡ è¿”å›ï¼›
    
å¼Šç«¯ï¼š
    è¿™æ ·ç¼–å†™æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºæ˜¯ç›´æ¥ç¡¬ç¼–ç çš„æ–¹å¼åˆ›å»ºå¯¹è±¡ã€‚
    æ‰€ä»¥æˆ‘ä»¬è€ƒè™‘åˆ°æœªæ¥å¯èƒ½æ–°å¢çš„ç±»ï¼Œå³æ–°çš„å® ç‰©å­ç±»ï¼Œè¿™æ ·çš„ä¹¦å†™æ–¹æ³•ï¼Œæ‰©å±•æ€§è¾ƒå·®ã€‚
    
ä½¿ç”¨åå°„çš„æ–¹å¼è§£å†³ï¼š
    åœ¨ç¼–ç æœŸé—´å¹¶ä¸ç›´æ¥å†™æ˜å…·ä½“åˆ›å»ºå“ªä¸ªå­ç±»å¯¹è±¡ï¼Œè€Œæ˜¯æ ¹æ®è°ƒç”¨è€…ä¼ å…¥çš„å…¨é™å®šåæ¥åˆ›å»ºå¯¹è±¡ã€‚
    è¿™æ ·æ›´åŠ çµæ´»ã€æ‰©å±•æ€§æ›´å¼ºã€ä¸ä¼šå—é™äºç¡¬ç¼–ç çš„å±€é™ã€‚   
```

> åœ¨ç¼–è¯‘æœŸé—´æ— æ³•ç¡®å®šå…·ä½“çš„ç±»åæ˜¯ä»€ä¹ˆï¼Œé€šè¿‡ä¼ å…¥ åŒ…å+ç±»åï¼Œå…¨é™å®šåçš„æ–¹å¼åˆ›å»ºå¯¹è±¡ï¼Œæ›´åŠ çµæ´»ã€‚
>
> åªæœ‰åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œæ‰ä¼šæŠŠåŒ…å+ç±»åä¼ å…¥ç»™ä»–ï¼Œè¿™å°±æ˜¯åå°„åšçš„äº‹æƒ…ï¼Œè¿™ä¹Ÿæ˜¯æ¡†æ¶åšçš„äº‹æƒ…ã€‚
>
> ç”¨äº†æ¡†æ¶ä»¥ååªç”¨å†™æ¥å£ï¼Œå†™SQLè¯­å¥ï¼Œå®ç°ç±»æ˜¯ä¸ç”¨å†™çš„ï¼Œä»–ä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆã€‚

```java
Springæ¡†æ¶ï¼šä»¥åä¸ä¼šç”¨newå…³é”®å­—äº†ï¼Œé€šè¿‡åå°„å’Œä»£ç†çš„æŠ€æœ¯ç»“åˆåˆ°äº†ä¸€èµ·ã€‚
```

```java
package com.ReflectPart.draw;

public class Master {
    // æŠ½å¥–è·å–å® ç‰©æ–¹æ³•ï¼Œå‚æ•°æ˜¯å­ç±»åç§° åŒ…å+ç±»åå…¨é™å®šåç§°
    public Pet getPet(String subClassName) {
        Pet pet = null;
        try {
            // é€šè¿‡ç±»ç±»å¯¹è±¡
            Class<?> aClass = Class.forName(subClassName);
            // åˆ›å»ºå®ä¾‹å¯¹è±¡ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯æ— å‚æ„é€ æ–¹æ³•åˆ›å»º
            Object obj = aClass.newInstance();
            // åˆ¤æ–­ç±»å‹ï¼Œç„¶åè½¬æ¢
            if (obj instanceof Pet){
                pet = (Pet) obj;
            }

        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        } catch (InstantiationException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        }
        // æŠŠå®ä¾‹è¿”å›
        return pet;
    }
}

```

```java
package com.ReflectPart.draw;

public class Test {
    public static void main(String[] args) {
        // åˆ›å»ºmaså¯¹è±¡
        Master mas = new Master();
        // è·å–å® ç‰©å¯¹è±¡
        Pet pet = mas.getPet("com.ReflectPart.draw.Dog");
        System.out.println("pet = " + pet); // pet = com.ReflectPart.draw.Dog@4554617c
    }
}
```

### è·å–å±æ€§

> ä¼˜åŠ¿ï¼šä¸éœ€è¦çŸ¥é“ç±»ä¸­çš„ä»£ç æ˜¯æ€ä¹ˆå†™çš„ï¼Œå¯ä»¥æå‰å†™å¥½ï¼Œç»™ç±»ä¸­çš„å±æ€§èµ‹å€¼ã€‚

```java
1. å…ˆè·å–åˆ°Classå¯¹è±¡
2. å†é€šè¿‡Classå¯¹è±¡ï¼Œè°ƒç”¨å¯¹åº”æ–¹æ³•ï¼Œè·å–åˆ°å­—æ®µ
```

ğŸ“ ä½¿ç”¨ç¤ºä¾‹ï¼šè·å– `public` ä¿®é¥°çš„å±æ€§

> é€šè¿‡ Classç±»ä¸­çš„ getFieldæ–¹æ³•è·å–ï¼ŒåŒæ—¶ä½¿ç”¨Fieldç±»ä¸­çš„setæ–¹æ³•èµ‹å€¼ã€‚

```java
package com.ReflectPart;

public class Vup {
    public String name;
    int age;

    public Vup() {
    }

    public Vup(String name, int age) {
        this.name = name;
        this.age = age;
    }
}
```

```java
package com.ReflectPart;

import java.lang.reflect.Field;

public class TestField1 {
    public static void main(String[] args) throws Exception {
        // é€šè¿‡åå°„è·å– ç±»çš„Classå¯¹è±¡
        Class<?> aClass = Class.forName("com.ReflectPart.Vup");
        // è·å–æ‰€æœ‰çš„publicä¿®é¥°çš„å­—æ®µå¯¹è±¡
        Field[] fields = aClass.getFields();
        // æ ¹æ®åç§°è·å–å•ä¸ªå­—æ®µå¯¹è±¡
        Field field1 = aClass.getField("name");
        // éå†
        for (Field field : fields) {
            // æ‰“å°ä¿¡æ¯
            // name - class java.lang.String - 1
            System.out.println(field.getName() + " - " + field.getType() +  " - " + field.getModifiers());
        }
        String name = field1.getName();
        System.out.println("name = " + name); // name = name
        // åˆ›å»ºå®ä¾‹å¯¹è±¡
        Object instance = aClass.newInstance();
        // è®¾ç½®å€¼
        field1.set(instance,"Hanser");
        // è¯»å–å€¼
        Object o = field1.get(instance);
        System.out.println("o = " + o); // o = Hanser
    }
}

```

ğŸ“ ä½¿ç”¨ç¤ºä¾‹ï¼šè·å– `private`ã€`protected` ä¿®é¥°çš„å±æ€§

> é€šè¿‡ Classç±»ä¸­çš„ getDeclaredField æ–¹æ³•è·å–ï¼ŒåŒæ—¶ä½¿ç”¨Fieldç±»ä¸­çš„setæ–¹æ³•èµ‹å€¼ã€‚

```java
package com.ReflectPart;

public class Vup {
    public String name;
    int age;
    private int height;

    public Vup() {
    }

    public Vup(String name, int age, int height) {
        this.name = name;
        this.age = age;
        this.height = height;
    }
}

```

```java
package com.ReflectPart;

import java.lang.reflect.Field;

public class TestField1 {
    public static void main(String[] args) throws Exception {
        // é€šè¿‡åå°„è·å– ç±»çš„Classå¯¹è±¡
        Class<?> aClass = Class.forName("com.ReflectPart.Vup");
        // è·å–æ‰€æœ‰çš„å·²å®šä¹‰çš„å­—æ®µå¯¹è±¡ è¿”å›å€¼ä¸ºå­—æ®µæ•°ç»„
        Field[] declaredFields = aClass.getDeclaredFields();
        // éå†å±æ€§æ•°ç»„
        for (Field declaredField : declaredFields) {
            System.out.println(declaredField.getName() + "-" + declaredField.getType() + "-" + declaredField.getModifiers());
        }
        // æ ¹æ®åç§°è·å–åˆ°å•ä¸ªå­—æ®µå¯¹è±¡
        Field field1 = aClass.getDeclaredField("height");
        // é€šè¿‡Vupç±» Classå¯¹è±¡ åˆ›å»º upç±»å®ä¾‹
        Object obj = aClass.newInstance();
        // è¡¨ç¤ºå¿½ç•¥JVMçš„å®‰å…¨æ£€æŸ¥ å³å¯ä»¥ä¸åœ¨åŒç±»ä¸­è®¿é—®ç§æœ‰å±æ€§
        field1.setAccessible(true);
        // å±æ€§èµ‹å€¼
        // ç¬¬ä¸€ä¸ªå‚æ•° è¡¨ç¤ºç»™å“ªä¸ªå¯¹è±¡çš„æ­¤å±æ€§èµ‹å€¼
        // ç¬¬äºŒæ ¹å‚æ•° å…·ä½“å€¼
        field1.set(obj,12);

        // è·å–å±æ€§å€¼ å‚æ•°è¡¨ç¤ºè·å–å“ªä¸ªå¯¹è±¡çš„æ­¤å±æ€§çš„å€¼
        System.out.println(field1.get(obj));
    }
}

```



### è·å–æ–¹æ³•

`java.lang.reflect.Method` æ–¹æ³•ç±»ï¼Œä»»ä½•ä¸€ä¸ªæ–¹æ³•éƒ½å±äºæ­¤ç±»çš„å®ä¾‹ï¼›

> é€šè¿‡ getMethod æ–¹æ³•å’ŒgetMethodsæ–¹æ³•è·å–æœ¬ç±»ä¸­publicä¿®é¥°çš„æ–¹æ³•ä»¥åŠç»§æ‰¿è‡ªçˆ¶ç±»çš„æ–¹æ³•ã€‚
>
> é€šè¿‡ getDeclareMethod() æ–¹æ³•å’Œ  getDeclareMethod() æ–¹æ³•è·å–ç±»ä¸­å·²å®šä¹‰çš„æ–¹æ³•ä»¥åŠå’Œç»§æ‰¿çˆ¶ç±»çš„æ–¹æ³•ã€‚

```java
package com.ReflectPart.getMethod;

public class Vup {
    public String name;
    int age;
    private int height;

    public Vup() {
    }

    public Vup(String name, int age, int height) {
        this.name = name;
        this.age = age;
        this.height = height;
    }
    // æ— å‚æ–¹æ³•
    public void m1(){
        System.out.println("æ— å‚æ–¹æ³•m1 start");
    }
    // æ— å‚æ–¹æ³•
    public void m2(int age){
        System.out.println("æœ‰å‚(int)æ–¹æ³•m2 start");
    }
    // æ— å‚æ–¹æ³•
    public void m3(int age,String name){
        System.out.println("æœ‰å‚(int String)æ–¹æ³•m3 start");
    }
    // æ— å‚æ–¹æ³•
    public void m3(int age,String name,int height){
        System.out.println("æœ‰å‚(int String int)æ–¹æ³•m3 start");
    }
}

```

```java
public static void main(String[] args) throws ClassNotFoundException, NoSuchMethodException, InstantiationException, IllegalAccessException, InvocationTargetException {
        // åˆ›å»ºç±»Classå¯¹è±¡
        Class<?> vupClass = Class.forName("com.ReflectPart.getMethod.Vup");
        // è·å–æœ¬ç±»ä¸­æ‰€æœ‰çš„publicä¿®é¥°çš„ä»¥åŠç»§æ‰¿çˆ¶ç±»çš„æ–¹æ³•
        Method[] methods = vupClass.getMethods();
        // æ ¹æ®æŒ‡å®šåç§°å’Œå‚æ•°åˆ—è¡¨è·å–æ–¹æ³•å¯¹è±¡å®ä¾‹
        Method m1 = vupClass.getMethod("m1");
        Method m3 = vupClass.getMethod("m3", int.class, String.class);

        // åˆ›å»ºç±»å¯¹è±¡å®ä¾‹
        Object o = vupClass.newInstance();
        // æ‰§è¡Œæ–¹æ³•
        m1.invoke(o);
        // å¿½ç•¥JVMè­¦å‘Š
        m3.setAccessible(true);
        m3.invoke(o,18,"hanser");

        // éå†æ‰€æœ‰æ–¹æ³•
        // for (Method method : methods) {
        //     // æ‰“å°ä¿¡æ¯
        //     String name = method.getName();
        //     int parameterCount = method.getParameterCount();
        //     System.out.println(name + " " + parameterCount);
        // }
    }
```

```java
public static void main(String[] args) throws ClassNotFoundException, NoSuchMethodException, InstantiationException, IllegalAccessException, InvocationTargetException {
    // åˆ›å»ºç±»Classå¯¹è±¡
    Class<?> vupClass = Class.forName("com.ReflectPart.getMethod.Vup");
    // è·å–æœ¬ç±»ä¸­å·²å®šä¹‰çš„æ–¹æ³•(ç§æœ‰æ–¹æ³•)
    Method m31 = vupClass.getDeclaredMethod("m3",int.class, String.class, int.class);
    Method[] declaredMethods = vupClass.getDeclaredMethods();
    // åˆ›å»ºç±»å¯¹è±¡å®ä¾‹
    Object o = vupClass.newInstance();
    // æ‰§è¡Œæ–¹æ³•
    // å¿½ç•¥JVMè­¦å‘Š
    m31.setAccessible(true);
    m31.invoke(o,18,"hanser",165);
    // éå†æ‰€æœ‰æœ¬ç±»æ–¹æ³•
    for (Method declaredMethod : declaredMethods) {
        //æ‰“å°ä¿¡æ¯
        String name = declaredMethod.getName();
        int parameterCount = declaredMethod.getParameterCount();
        System.out.println(name + " " + parameterCount);
    }

}
```



### è·å–æ„é€ å™¨

> Java.lang.reflect.Constructor ç±» æ‰€æœ‰æ„é€ å™¨éƒ½å±äºæ­¤ç±»çš„å®ä¾‹ã€‚

ç¤ºä¾‹1ï¼šè·å–å…¬å¼€çš„æ„é€ å™¨æ–¹æ³•ã€‚

```java
package com.ReflectPart;

public class Vup {
    public String name;
    int age;
    private int height;

    public Vup() {
        
    }
	private Vup(String name) {
        this.name = name;
    }
    public Vup(String name, int age, int height) {
        this.name = name;
        this.age = age;
        this.height = height;
    }

    @Override
    public String toString() {
        return "Vup{" +
                "name='" + name + '\'' +
                ", age=" + age +
                ", height=" + height +
                '}';
    }
}
```

```java
// è·å–classç±»å¯¹è±¡
Class<?> vupClass = Class.forName("com.ReflectPart.Vup");
// è·å–æ— å‚æ„é€ 
Constructor<?> constructor = vupClass.getConstructor();
// è·å–æœ‰å‚æ„é€ 
Constructor<?> constructor1 = vupClass.getConstructor(String.class, int.class, int.class);
// è°ƒç”¨æ–¹æ³•
int parameterCount = constructor.getParameterCount(); // 0
// com.ReflectPart.getConstructor.Vup
String name = constructor.getName(); 
// åˆ›å»ºå®ä¾‹å¯¹è±¡ vup
Object o1 = constructor.newInstance();
Object o2 = constructor1.newInstance("hanser",18,156);
sout
```

ç¤ºä¾‹2ï¼šè·å–æ‰€æœ‰çš„æ„é€ å™¨æ–¹æ³•ã€‚

```java
Class<?> vupClass = Class.forName("com.ReflectPart.Vup");
Constructor<?>[] declaredConstructors = vupClass.getDeclaredConstructors();
// éå†
for (Constructor<?> con : declaredConstructors) {
    System.out.println(con.getName() + "---" + con.getParameterCount());
}
Constructor<?> con1 = vupClass.getDeclaredConstructor(String.class);
// å¿½ç•¥å‘Šè­¦
con1.setAccessible(true);
// åˆ›å»ºVupå®ä¾‹å¯¹è±¡
Object obj1 = con1.newInstance("èµµå››");
// æ‰“å°
System.out.println("obj1 = " + obj1);
```



### è·å–æ³¨è§£

âš¡ï¸ é€šè¿‡åå°„è·å–æ³¨è§£çš„è¿‡ç¨‹ï¼š

> é¦–å…ˆå®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰çš„æ³¨è§£ï¼Œè®¾ç½®å¥½å…ƒæ³¨è§£ï¼ŒåŒæ—¶è®¾ç½®æ³¨è§£çš„å±æ€§ï¼Œç„¶ååœ¨ç±»ä¸­çš„å±æ€§ä¸Šè®¾ç½®æ³¨è§£ï¼Œç„¶åé€šè¿‡åå°„å…ˆè·å–åˆ°ç±»ä¸­çš„å±æ€§ï¼Œç„¶åé€šè¿‡å±æ€§åç§°è·å–åˆ°æ³¨è§£ä¸­å±æ€§çš„å€¼ï¼Œä»è€Œè¾¾åˆ°è·å–é…ç½®çš„ç›®çš„ã€‚

ğŸ¨ è·å–é…ç½®æ–‡ä»¶å‚æ•°çš„ä¸¤ç§æ–¹å¼ï¼š

* 1ã€é€šè¿‡è·å–æ³¨è§£ä¸­çš„å‚æ•°è·å–é…ç½®ã€‚
* 2ã€é€šè¿‡Propertiesç±»ä¸­çš„Loadæ–¹æ³•ï¼Œä¼ é€’ä¸€ä¸ªIOæµè·å–ä¸€ä¸ªPropertieså¯¹è±¡è·å–é…ç½®ã€‚

âœ¨ æ³¨è§£å’Œåå°„ç»“åˆçš„æ­¥éª¤ï¼š

> 1ã€å…ˆè·å–åˆ°å½“å‰ç±»å¯¹è±¡ å³Classå¯¹è±¡
>
> 2ã€æ ¹æ®Classå¯¹è±¡è·å–åˆ°æœ¬ç±»ä¸­æ‰€æœ‰çš„å±æ€§
>
> 3ã€æ ¹æ®å±æ€§å¯¹è±¡è·å–åˆ°å±æ€§ä¸Šæ–¹æ·»åŠ çš„æ³¨è§£å¯¹è±¡
>
> 4ã€æ ¹æ®æ³¨è§£å¯¹è±¡è·å–åˆ°å±æ€§å€¼

ç”¨åˆ°çš„æ–¹æ³•æœ‰ getAnnotation()ï¼ŒgetAnnotations()ï¼ŒgetDeclaredAnnotation()ï¼ŒgetDeclaredAnnotations()ã€‚

è¿™äº›æ–¹æ³•éƒ½æ˜¯Fieldç±»ä¸­çš„æ–¹æ³•ã€‚

ğŸ“Œ **æ³¨è§£å’Œåå°„ç»“åˆæ¡ˆä¾‹1ï¼šè·å–æ•°æ®åº“ä¿¡æ¯**ï¼ˆå‚è€ƒæ³¨è§£ç« èŠ‚ï¼‰ï¼š

å®šä¹‰ç”¨æˆ·åå±æ€§æ³¨è§£

```java
package com.ReflectPart.AnnoAndReflect.DataBaseDemo;

import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

@Target(ElementType.FIELD)
@Retention(RetentionPolicy.RUNTIME)
public @interface UserName {
    String value();
}
```

å®šä¹‰å¯†ç å±æ€§æ³¨è§£

```java
package com.ReflectPart.AnnoAndReflect.DataBaseDemo;

import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

@Target(ElementType.FIELD)
@Retention(RetentionPolicy.RUNTIME)
public @interface Password {
    String value();
}
```

å®šä¹‰URLå±æ€§æ³¨è§£

```java
package com.ReflectPart.AnnoAndReflect.DataBaseDemo;

import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

@Target(ElementType.FIELD)
@Retention(RetentionPolicy.RUNTIME)
public @interface URL {
    String url();
}
```

å®šä¹‰é©±åŠ¨å±æ€§æ³¨è§£

```java
package com.ReflectPart.AnnoAndReflect.DataBaseDemo;

import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

@Target(ElementType.FIELD)
@Retention(RetentionPolicy.RUNTIME)
public @interface Driver {
    String value();
}
```

è®¾ç½®æ³¨è§£ï¼Œä½¿ç”¨åå°„è·å–æ³¨è§£å¯¹è±¡ï¼Œç„¶åä½¿ç”¨æ³¨è§£å¯¹è±¡æ–¹æ³•è·å–å€¼ã€‚

```java
package com.ReflectPart.AnnoAndReflect.DataBaseDemo;

import java.lang.reflect.Field;
import java.lang.reflect.Method;

public class Test {
    public static void main(String[] args) {
        // è·å–classç±»å¯¹è±¡
        try {
            Class<?> dataClass = Class.forName("com.ReflectPart.AnnoAndReflect.DataBaseDemo.DataInfo");
            // è·å–å±æ€§
            Field[] declaredFields = dataClass.getDeclaredFields();
            // éå†å±æ€§
            for (Field declaredField : declaredFields) {
                // æ‰“å°å±æ€§åç§°å’Œç±»å‹
                System.out.println(declaredField.getName() + "**" + declaredField.getType());
                // åˆ¤æ–­å±æ€§ä¸Šæ˜¯å¦æ·»åŠ äº† UserName æ³¨è§£
                if (declaredField.isAnnotationPresent(UserName.class)){
                    // è·å–æ³¨è§£å®ä¾‹å¯¹è±¡
                    UserName name = declaredField.getAnnotation(UserName.class);
                    // è·å–æ³¨è§£å±æ€§çš„å€¼
                    String value = name.value();
                    System.out.println("value = " + value);
                }
            }
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        }

    }
}

```

```java
package com.ReflectPart.AnnoAndReflect.DataBaseDemo;

public class DataInfo {
    // å®šä¹‰å±æ€§
    @UserName("root")
    private String userName;

    @Password("****")
    private String password;

    @URL(url = "jdbc:mysql://localhost:3306/dbName")
    private String URL;

    @Driver("com.mysql.cj.jdbc.Driver")
    private String driver;

    public DataInfo(String userName, String password, String URL, String driver) {
        this.userName = userName;
        this.password = password;
        this.URL = URL;
        this.driver = driver;
    }
}

```



## Junitæ¡†æ¶

JUnit Java Unit å•å…ƒæµ‹è¯•æ¡†æ¶ æ˜¯ä¸€ä¸ªå•ç‹¬ç”¨äºJavaæµ‹è¯•çš„å·¥å…·ï¼›

æ¡†æ¶ï¼šåˆ«äººå†™å¥½çš„ä¸€äº›ç±»ï¼ŒåŒ…ï¼Œä¸€ä¸ªåŒ…ä¸­åŒ…å«äº†å¾ˆå¤šç±»ï¼Œæ‰“æˆjaråŒ…ä¹‹åï¼›

JUnitæä¾›äº†å¾ˆå¤šæ³¨è§£ æ–¹ä¾¿æˆ‘ä»¬æµ‹è¯•ä»£ç  åœ¨éœ€è¦æµ‹è¯•çš„æŸä¸ªæ–¹æ³•ä¸Šæ–¹ æ·»åŠ æŸä¸ªæ³¨è§£ å°±å¯ä»¥å®ç°æµ‹è¯•çš„æ•ˆæœï¼›

### Junitæ³¨è§£

> * @Test  è¡¨ç¤ºå½“å‰æ–¹æ³•å¯ä»¥ç‹¬ç«‹æ‰§è¡Œï¼›
>
> * @After ç±»ä¸­çš„æ¯ä¸ªæ–¹æ³•æ‰§è¡Œä¹‹åï¼Œæ­¤æ–¹æ³•ä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ï¼›
>
> * @Before ç±»ä¸­çš„æ¯ä¸ªæ–¹æ³•æ‰§è¡Œä¹‹å‰ï¼Œæ­¤æ–¹æ³•ä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ï¼›
>
> * @AfterClass å½“å‰ç±»ä¸­çš„æ‰€æœ‰çš„æ–¹æ³•ï¼Œæ‰§è¡Œä¹‹åï¼Œåªæ‰§è¡Œä¸€æ¬¡ï¼Œæ­¤æ³¨è§£åªèƒ½æ·»åŠ åœ¨é™æ€æ–¹æ³•ä¸Šï¼›
>
> * @BeforeClass å½“å‰ç±»ä¸­çš„æ‰€æœ‰çš„æ–¹æ³•ï¼Œæ‰§è¡Œä¹‹å‰ï¼Œåªæ‰§è¡Œä¸€æ¬¡ï¼Œæ­¤æ³¨è§£åªèƒ½æ·»åŠ åœ¨é™æ€æ–¹æ³•ä¸Šï¼›

âš¡ï¸ **çº¦å®š**

```java
å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬æµ‹è¯•çš„ä»£ç ï¼Œä¼šå•ç‹¬ä¿å­˜åœ¨äºsrcå¹³çº§çš„testæ–‡ä»¶å¤¹ï¼ˆæ–°å»ºä¸€ä¸ªï¼‰ä¸­ï¼Œå³é”®å°†æ­¤æ–‡ä»¶å¤¹æ ‡è®°ä¸ºæµ‹è¯•èµ„æºæ ¹ç›®å½•ï¼›
```

### åŸºæœ¬ä½¿ç”¨

```java
1ã€å¯¼åŒ…

Junitä¸å±äºJavaä¸­çš„JDKè‡ªå¸¦çš„åŒ…ï¼Œæ‰€ä»¥é¦–å…ˆéœ€è¦å¯¼å…¥jaråŒ…ï¼›
    
å…ˆå†ç±»ä¸­å†™ä¸€ä¸ª @Test,ç„¶åideaä½¿ç”¨alté”®+å›è½¦é”®ï¼Œé€‰æ‹©Add 'Junit4' to classpath (4ç¨³å®šç‰ˆæœ¬)ï¼ŒæŠŠ4ç‰ˆæœ¬çš„junitçš„javaæ–‡ä»¶å¯¼å…¥åˆ°ç±»è·¯å¾„ä¸­ã€‚ideaé»˜è®¤ä»mavenä»“åº“ä¸­ä¸‹è½½ã€‚
    
2ã€åœ¨å·¦ä¾§ç‚¹å‡»è¿è¡Œ
    
3ã€ç‚¹å‡»ç±»å£°æ˜å·¦ä¾§çš„æ’­æ”¾æŒ‰é’®ï¼Œä¼šè‡ªåŠ¨æŠŠç±»ä¸­çš„æ‰€æœ‰@Testæµ‹è¯•ç±»éƒ½æ‰§è¡Œ
```

**ä½¿ç”¨æ¡ˆä¾‹**

```java
package com.ReflectPart.Junit;

import org.junit.*;

public class TestJunit {
    @Before
    public void before(){
        System.out.println("å½“å‰ç±»ä¸­çš„æ¯ä¸ªå®ä¾‹æ–¹æ³•æ‰§è¡Œä¹‹å‰ æ­¤æ–¹æ³•ä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ ");
    }
    @After
    public void after(){
        System.out.println("å½“å‰ç±»ä¸­çš„æ¯ä¸ªå®ä¾‹æ–¹æ³•æ‰§è¡Œä¹‹å æ­¤æ–¹æ³•ä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ ");
    }
    @BeforeClass
    public static void beforeClass(){
        System.out.println("*******å½“å‰ç±»ä¸­çš„æ–¹æ³• æ‰§è¡Œä¹‹å‰ åªæ‰§è¡Œä¸€æ¬¡*******");
    }

    @AfterClass
    public static void afterClass(){
        System.out.println("*******å½“å‰ç±»ä¸­çš„æ–¹æ³• æ‰§è¡Œä¹‹å åªæ‰§è¡Œä¸€æ¬¡*******");
    }

    @Test
    public void m1(){
        System.out.println("hello world m1");
    }

    @Test
    public void m2(){
        System.out.println("hello world m2");
    }
}

```

```kotlin
*******å½“å‰ç±»ä¸­çš„æ–¹æ³• æ‰§è¡Œä¹‹å‰ åªæ‰§è¡Œä¸€æ¬¡*******
å½“å‰ç±»ä¸­çš„æ¯ä¸ªå®ä¾‹æ–¹æ³•æ‰§è¡Œä¹‹å‰ æ­¤æ–¹æ³•ä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ 
hello world m1
å½“å‰ç±»ä¸­çš„æ¯ä¸ªå®ä¾‹æ–¹æ³•æ‰§è¡Œä¹‹å æ­¤æ–¹æ³•ä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ 
å½“å‰ç±»ä¸­çš„æ¯ä¸ªå®ä¾‹æ–¹æ³•æ‰§è¡Œä¹‹å‰ æ­¤æ–¹æ³•ä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ 
hello world m2
å½“å‰ç±»ä¸­çš„æ¯ä¸ªå®ä¾‹æ–¹æ³•æ‰§è¡Œä¹‹å æ­¤æ–¹æ³•ä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ 
*******å½“å‰ç±»ä¸­çš„æ–¹æ³• æ‰§è¡Œä¹‹å åªæ‰§è¡Œä¸€æ¬¡*******
```

**è‡ªå®šä¹‰Junit**

```java
// å’ŒJunitå·®ä¸€ä¸ªæ’­æ”¾ï¼ˆè¿è¡Œï¼‰é”®

package com.ReflectPart.MyTest;

import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;

public class Demo {
    @MyTest
    public void m1(){
        System.out.println("m1æ–¹æ³•æ‰§è¡Œ");
    }

    public static void main(String[] args) {
        // è·å–classå¯¹è±¡
        Class<?> testClass = null;
        try {
            testClass = Class.forName("com.ReflectPart.MyTest.Demo");
        } catch (ClassNotFoundException e) {
            throw new RuntimeException(e);
        }
        // è·å–æ–¹æ³•
        Method[] methods = testClass.getDeclaredMethods();
        // åˆ›å»ºå®ä¾‹
        Object demo = null;
        try {
            demo = testClass.newInstance();
        } catch (InstantiationException e) {
            throw new RuntimeException(e);
        } catch (IllegalAccessException e) {
            throw new RuntimeException(e);
        }
        for (Method method : methods) {
            if (method.isAnnotationPresent(MyTest.class)){
                // æ‰§è¡Œæ–¹æ³•
                try {
                    Object res = method.invoke(demo);
                } catch (IllegalAccessException e) {
                    throw new RuntimeException(e);
                } catch (InvocationTargetException e) {
                    throw new RuntimeException(e);
                }

            }
        }
    }
}

```

```java
package com.ReflectPart.MyTest;

import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface MyTest {

}

```



## ç±»åŠ è½½å™¨

ClassLoader æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå±äºç±»åŠ è½½å™¨ã€‚

jaræ–‡ä»¶å°±æ˜¯javaä¸­çš„å‹ç¼©æ–‡ä»¶ï¼Œæ‰“åŒ…åçš„æ–‡ä»¶ã€‚ä½¿ç”¨è§£å‹æ–‡ä»¶å°±å¯ä»¥è§£å‹ã€‚

> ç±»åŠ è½½çš„ä½œç”¨ï¼šåŠ è½½ç±»

ç±»åŠ è½½çš„è¿‡ç¨‹(è¯´ä¸€ä¸ªå¤§æ¦‚å°±è¡Œ)ï¼š

```java
å½“ç¨‹åºä¸»åŠ¨ä½¿ç”¨æŸä¸ªç±»æ—¶ï¼Œå¦‚æœè¯¥ç±»è¿˜æœªè¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œåˆ™ç³»ç»Ÿä¼šé€šè¿‡å¦‚ä¸‹ä¸‰ä¸ªæ­¥éª¤æ¥å¯¹è¯¥ç±»è¿›è¡Œåˆå§‹åŒ–ã€‚

1ã€åŠ è½½ç±»(load) ï¼š å°†ç±»çš„classæ–‡ä»¶è¯»å…¥å†…å­˜ï¼Œå¹¶ä¸ºä¹‹åˆ›å»ºä¸€ä¸ªjava.lang.Classå¯¹è±¡ã€‚
    æ­¤è¿‡ç¨‹ç”±ç±»åŠ è½½å™¨å®Œæˆå°†classæ–‡ä»¶å­—èŠ‚ç å†…å®¹åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¹¶å°†è¿™äº›æ•°æ®è½¬æ¢æˆæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„java.lang.Classå¯¹è±¡ã€‚è¿™ä¸ªåŠ è½½çš„è¿‡ç¨‹éœ€è¦ç±»åŠ è½½å™¨å‚ä¸ã€‚



2ã€é“¾æ¥(link) ï¼š å°†ç±»çš„äºŒè¿›åˆ¶æ•°æ®åˆå¹¶åˆ°JREï¼ˆè¿è¡Œç¯å¢ƒä¸­ï¼‰ä¸­ï¼š
éªŒè¯ï¼šç¡®ä¿åŠ è½½çš„ç±»ä¿¡æ¯ç¬¦åˆJVMè§„èŒƒï¼Œä¾‹å¦‚ï¼šä½¿ç”¨äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆbinary viewerï¼‰æŸ¥çœ‹å™¨ï¼ŒæŸ¥çœ‹æ–‡ä»¶å†…å®¹ä»¥cafeå¼€å¤´ï¼Œæ²¡æœ‰å®‰å…¨æ–¹é¢çš„é—®é¢˜ï¼›
å‡†å¤‡ï¼šæ­£å¼ä¸ºç±»å˜é‡ï¼ˆstaticï¼‰åˆ†é…å†…å­˜å¹¶è®¾ç½®ç±»å˜é‡é»˜è®¤åˆå§‹å€¼çš„é˜¶æ®µï¼Œè¿™äº›å†…å­˜éƒ½å°†åœ¨æ–¹æ³•åŒºä¸­è¿›è¡Œåˆ†é…(é™æ€åŒº)ã€‚
è§£æï¼šå°†ç±»ã€æ¥å£ã€å­—æ®µå’Œæ–¹æ³•çš„ç¬¦å·å¼•ç”¨è½¬ä¸ºç›´æ¥å¼•ç”¨ã€‚

    
3ã€åˆå§‹åŒ–(Initialize) : JVMè´Ÿè´£å¯¹ç±»è¿›è¡Œåˆå§‹åŒ–ï¼š

æ‰§è¡Œç±»æ„é€ å™¨<clinit>()æ–¹æ³•çš„è¿‡ç¨‹ã€‚ç±»æ„é€ å™¨<clinit>()æ–¹æ³•æ˜¯ç”±ç¼–è¯‘æœŸè‡ªåŠ¨æ”¶é›†ç±»ä¸­æ‰€æœ‰ç±»å˜é‡çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€ä»£ç å—ä¸­çš„è¯­å¥åˆå¹¶äº§ç”Ÿçš„ã€‚ï¼ˆç±»æ„é€ å™¨æ˜¯æ„é€ ç±»ä¿¡æ¯çš„ï¼Œä¸æ˜¯æ„é€ è¯¥ç±»å¯¹è±¡çš„æ„é€ å™¨ï¼‰ã€‚

å½“åˆå§‹åŒ–ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°å…¶çˆ¶ç±»è¿˜æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶çˆ¶ç±»çš„åˆå§‹åŒ–ã€‚
è™šæ‹Ÿæœºä¼šä¿è¯ä¸€ä¸ªç±»çš„<clinit>()æ–¹æ³•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­è¢«æ­£ç¡®åŠ é”å’ŒåŒæ­¥ã€‚
```

ç±»åŠ è½½å™¨çš„åˆ†ç±»ï¼š

```java
%JAVA_HOME%/jre/lib/rt.jarï¼›rt ä¸º RunTime çš„å«ä¹‰ï¼›æ­¤ç±»åŠ è½½åº•å±‚ä¸ºC++ å®ç° åœ¨Javaä»£ç ä¸­æ— æ³•è·å–ï¼›
// åŠ è½½æ ¸å¿ƒç±»    
Object obj = new Object()
ClassLoader classLoader = obj.getClass().getClassLoader(); // classLoader = null
```

> BootStrap ClassLoader è´Ÿè´£åŠ è½½æ ¸å¿ƒç±»åº“ï¼Œä¾‹å¦‚ï¼šrt.jar
>
> Extension ClassLoader è´Ÿè´£åŠ è½½æ‰©å±•åŒ…ï¼Œ %JAVA_HOME%/jre/lib/ext/*.jar
>
> Application ClassLoader  è´Ÿè´£åŠ è½½è‡ªå®šä¹‰çš„ç±»ã€‚
>
> è‡ªå®šä¹‰ç±»åŠ è½½å™¨  ç»§æ‰¿ClassLoaderç±»ï¼Œé‡å†™ findClassæ–¹æ³•ï¼ˆäº†è§£ï¼‰ã€‚

```java
å…³ç³»ï¼š

Application ClassLoader å±äº Extension ClassLoaderçš„å­åŠ è½½å™¨
Extension ClassLoader  å±äº BootStrap ClassLoader çš„å­åŠ è½½å™¨
```

```java
package com.ReflectPart.classLoader;

import sun.net.spi.nameservice.dns.DNSNameService;

public class TestClassLoader {
    public static void main(String[] args) {
        // BootStrap ClassLoader åŠ è½½å™¨çš„ä½¿ç”¨
        Object obj = new Object();
        // è·å–å¯¹è±¡çš„ç±»åŠ è½½å™¨
        ClassLoader classLoader = obj.getClass().getClassLoader();
        System.out.println("classLoader = " + classLoader); // null

        // æ‹“å±•åŒ…åŠ è½½
        ClassLoader classLoader1 = DNSNameService.class.getClassLoader();
        System.out.println("classLoader1 = " + classLoader1); // sun.misc.Launcher$ExtClassLoader@2503dbd3

        // è‡ªå®šä¹‰ç±»
        ClassLoader classLoader2 = TestClassLoader.class.getClassLoader();
        System.out.println("classLoader2 = " + classLoader2); // sun.misc.Launcher$AppClassLoader@18b4aac2

        // è·å–çˆ¶ç±»åŠ è½½å™¨
        ClassLoader parent = classLoader2.getParent();
        System.out.println("parent = " + parent); // sun.misc.Launcher$ExtClassLoader@2503dbd3
    }
}

```

**é¢è¯•é¢˜ï¼š**

```java
åŒäº²å§”æ´¾æ¨¡å‹/æœºåˆ¶ï¼š
å½“JVMé€šè¿‡ç±»åŠ è½½å™¨åŠ è½½æŸä¸€ä¸ªç±»ï¼Œä¼šå…ˆå§”æ‰˜ç»™ä¸Šçº§ç±»åŠ è½½å™¨æ¥åŠ è½½ï¼Œå¦‚æœä¸Šçº§ç±»åŠ è½½å™¨ä¸­æ— æ³•åŠ è½½ï¼Œå†å‘ä¸‹ç”±å­åŠ è½½å™¨åŠ è½½ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢äººä¸ºçš„ç¼–å†™å’ŒJDKåŒ…åç±»åå®Œå…¨ç›¸åŒçš„ç±» æ±¡æŸ“ï¼Œå…¥ä¾µJDKçš„æºä»£ç 
```

![image-20250812173521012](https://2216847528.oss-cn-beijing.aliyuncs.com/asset/image-20250812173521012.png)

