# 配置环境

## Java环境

Linux配置Java环境，检查是否存在Java环境

```java
java -version
```

使用yum安装JDK

```java
yum install -y java-1.8.0-openjdk java-1.8.0-openjdk-devel
    
java -version
```

手动安装 Oracle JDK（更稳定）

```java
https://www.oracle.com/java/technologies/javase/javase8-archive-downloads.html?utm_source=chatgpt.com

先去 Oracle 官网，下载 jdk-8uXXX-linux-x64.tar.gz
    
解压到 /usr/local/java
    
mkdir -p /usr/local/java
tar -zxvf jdk-8u*.tar.gz -C /usr/local/java
    
配置环境变量
vim /etc/profile

在文件末尾添加
// 在 Linux 里，export 语句 等号 左右不能有空格。
export JAVA_HOME=/usr/lib/jvm/java-1.8.0  # yum 安装路径
# 如果是手动安装就写 /usr/local/java/jdk1.8.0_421
export PATH=$PATH:$JAVA_HOME/bin
export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar

保存退出后执行
source /etc/profile

验证是否生效
java -version
echo $JAVA_HOME
    

```

额外（多版本切换）

```java
如果你的机器有多个 Java 版本，可以用
alternatives --config java
```



## Tomcat环境

确认 JDK 已安装

```java
java -version
    
// 要求 JDK 8+（Tomcat 9 建议 JDK 8，Tomcat 10 建议 JDK 11+）
    
下载 Tomcat
https://tomcat.apache.org/download-10.cgi?utm_source=chatgpt.com


```

解压到指定目录

```java
tar -zxvf apache-tomcat-10.1.28.tar.gz -C /usr/local/
```

解压后目录一般为 `/usr/local/apache-tomcat-10.1.28`

建立软链接（方便管理）

```
ln -s /usr/local/apache-tomcat-10.1.28 /usr/local/tomcat
```

配置环境变量

```ts
vim /etc/profile

在文件末尾加入
export CATALINA_HOME=/usr/local/tomcat
export PATH=$PATH:$CATALINA_HOME/bin

保存退出后执行
source /etc/profile
```

启动与停止

```ts
进入 bin 目录，执行

cd /usr/local/tomcat/bin
./startup.sh    # 启动
./shutdown.sh   # 停止

检查是否启动成功
ps -ef | grep tomcat
netstat -tunlp | grep 8080

访问
http://<服务器IP>:8080
```

部署 Web 应用

方式一：拷贝 war 包

```ts
把 yourapp.war 拷贝到
/usr/local/tomcat/webapps/
```

方式二：配置 `server.xml`

```ts
编辑 /usr/local/tomcat/conf/server.xml，增加一个 <Context>
    
<Context path="/yourapp" docBase="/home/project/yourapp" reloadable="true"/>
```

**设置开机自启**

新建服务文件

```
vim /etc/systemd/system/tomcat.service
```

写入以下内容

```ts
[Unit]
Description=Apache Tomcat Web Application Container
After=network.target

[Service]
Type=forking
Environment=JAVA_HOME=/usr/lib/jvm/java-11
Environment=CATALINA_HOME=/usr/local/tomcat
ExecStart=/usr/local/tomcat/bin/startup.sh
ExecStop=/usr/local/tomcat/bin/shutdown.sh
User=root
Group=root
Restart=always

[Install]
WantedBy=multi-user.target

```

保存后执行

```ts
systemctl daemon-reload
systemctl enable tomcat
systemctl start tomcat
systemctl status tomcat
```

**防火墙开放端口**

如果服务器开启了防火墙，需要放行 8080 端口

```java
firewall-cmd --zone=public --add-port=8080/tcp --permanent
firewall-cmd --reload

```

控制 **Tomcat** 的启停

```ts
新建一个 service 文件

vim /etc/systemd/system/tomcat.service
```

写入内容（假设 JDK1.8 已安装，Tomcat 路径 /usr/local/tomcat）

```ts
[Unit]
Description=Apache Tomcat Web Application Container
After=network.target

[Service]
Type=forking
Environment=JAVA_HOME=/usr/lib/jvm/java-1.8.0
Environment=CATALINA_HOME=/usr/local/tomcat
ExecStart=/usr/local/tomcat/bin/startup.sh
ExecStop=/usr/local/tomcat/bin/shutdown.sh
User=root
Group=root
Restart=always

[Install]
WantedBy=multi-user.target

```

让 systemd 重新加载配置

```ts
systemctl daemon-reload

```

设置开机自启并启动

```ts
systemctl enable tomcat
systemctl start tomcat
systemctl status tomcat

```

之后就可以用

```ts
systemctl stop tomcat
systemctl restart tomcat

```

## Spring Boot环境

如果你是直接运行 `java -jar app.jar`。可以这样，新建一个 service 文件。

```ts
vim /etc/systemd/system/myapp.service
```

写入

```ts
[Unit]
Description=My Spring Boot Application
After=network.target

[Service]
Type=simple
User=root
ExecStart=/usr/lib/jvm/java-1.8.0/bin/java -jar /home/project/myapp.jar --server.port=8081
Restart=on-failure

[Install]
WantedBy=multi-user.target
```

生效并启动

```ts
systemctl daemon-reload
systemctl enable myapp
systemctl start myapp

```

常用 systemctl 命令

```ts
systemctl start tomcat     # 启动
systemctl stop tomcat      # 停止
systemctl restart tomcat   # 重启
systemctl status tomcat    # 查看状态
systemctl enable tomcat    # 开机自启
systemctl disable tomcat   # 禁止开机自启

```

## CMD命令

```js
// 切换盘符
cd /d D:// 

// 查看服务
netstat -ano | findstr "8080"


```

